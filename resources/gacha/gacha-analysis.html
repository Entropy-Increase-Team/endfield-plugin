<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{title}} - {{subtitle}}</title>
  <link rel="stylesheet" href="{{_res_path}}gacha/gacha-analysis.css">
</head>
<body>
  <div class="gacha-analysis-container">
    <div class="list-top-bar">
      <div class="user-info">
        {{if userAvatar}}
        <img src="{{userAvatar}}" alt="用户头像" class="user-avatar">
        {{/if}}
        <div class="user-details">
          <div class="user-name">{{userNickname}}</div>
          <div class="user-uid">UID {{userUid}}</div>
        </div>
      </div>
      <div class="list-header-middle">
        <h1 class="list-title">{{title}}</h1>
        <p class="list-count">{{subtitle}}</p>
      </div>
      {{if pluResPath}}
      <div class="logo-container list-top-bar-logo">
        <img src="{{pluResPath}}img/logo.png" alt="Logo" class="logo-image">
      </div>
      {{/if}}
    </div>

    <div class="card-wrap pools-card">
      <div class="section-head section-head-time">
        <span class="analysis-time">{{analysisTime}}</span>
      </div>

      {{each poolGroups}}
      <div class="pool-group-wrap">
        <div class="pool-group-title">{{$value.label}}</div>
        {{if !$value.pools || $value.pools.length === 0}}
        <div class="pool-group-empty">暂无记录</div>
        {{else}}
        {{each $value.pools}}
        <div class="pool-row-wrap">
          {{if $value.poolName != '免费'}}
          <div class="pool-row-header">
            <span class="pool-row-pool-name">{{$value.poolName}}</span>
          </div>
          {{/if}}
          {{if $value.poolName != '免费'}}
          <div class="pool-row-metrics">
            <span class="metric-total">{{$value.total}} 抽数</span>
            <span class="metric-a">{{$value.metric1Label}} {{$value.metric1}}</span>
            <span class="metric-b">{{$value.metric2Label}} {{$value.metric2}}</span>
          </div>
          {{/if}}
          {{if ($value.images && $value.images.length > 0) || $value.pitySinceLast6 != null}}
          <div class="pool-star6-list">
            {{if $value.pitySinceLast6 != null && $value.poolName != '免费'}}
            <div class="pool-star6-entry pool-pity-row">
              <div class="pool-star6-icon pool-star6-icon-pity">?</div>
              <div class="pool-star6-bar-wrap">
                <div class="pool-star6-bar-inner pool-star6-badge-pity pool-star6-bar-inner-not-full" style="width: {{$value.pityBarPercent || 0}}%;">
                  <span class="pool-star6-bar-text">已垫 {{$value.pitySinceLast6}}</span>
                </div>
              </div>
            </div>
            {{/if}}
            {{if $value.images && $value.images.length > 0}}
            {{each $value.images}}
            <div class="pool-star6-entry">{{if $value.url}}<img class="pool-star6-icon" src="{{$value.url}}" alt="{{$value.name}}" onerror="this.style.display='none'">{{else}}<div class="pool-star6-icon pool-star6-icon-placeholder pool-star6-icon-free">×</div>{{/if}}
              <div class="pool-star6-bar-wrap">{{if $value.refLinePercent != null}}<div class="pool-star6-bar-ref" style="left: {{$value.refLinePercent}}%;"></div>{{/if}}
                <div class="pool-star6-bar-inner pool-star6-badge-{{$value.badgeColor || 'normal'}}{{if $value.barPercent < 100}} pool-star6-bar-inner-not-full{{/if}}" style="width: {{$value.barPercent || 50}}%;">
                  <span class="pool-star6-bar-text">{{if $value.isFreeRow}}免费 - {{$value.pullCount}}抽{{else}}{{$value.pullCount}}抽{{/if}}</span>
                </div>
              </div>{{if $value.tag && !$value.isFreeRow}}<span class="pool-star6-tag pool-star6-tag-{{$value.badgeColor}}">{{$value.tag}}</span>{{/if}}
            </div>
            {{/each}}
            {{/if}}
          </div>
          {{/if}}
        </div>
        {{/each}}
        {{/if}}
      </div>
      {{/each}}
    </div>
  </div>
</body>
</html>
