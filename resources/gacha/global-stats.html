<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width={{pageWidth}}, initial-scale=1">
  <title>{{title}} - {{poolChartTitle}}</title>
  <link rel="stylesheet" href="{{_res_path}}gacha/global-stats.css">
</head>
<body>
  <div class="gacha-stats-container" style="min-width: {{pageWidth}}px; max-width: {{pageWidth}}px;">
    <!-- 顶栏：标题居中显示 -->
    <div class="list-top-bar">
      <div class="list-header-center list-header-middle">
        <h1 class="list-title">{{title}}</h1>
        <p class="list-count">{{poolChartTitle}} · {{syncTime}}</p>
      </div>
      <div class="logo-container list-top-bar-logo">
        {{if pluResPath}}
        <img src="{{pluResPath}}img/ET logo.svg" alt="Logo" class="logo-image">
        {{/if}}
      </div>
    </div>

    <div class="overview-grid">
      <div class="card-wrap overview-item">
        <div class="label">总抽数</div>
        <div class="value">{{totalPulls}}</div>
      </div>
      <div class="card-wrap overview-item">
        <div class="label">统计用户</div>
        <div class="value">{{totalUsers}}</div>
      </div>
      <div class="card-wrap overview-item">
        <div class="label">6星总数</div>
        <div class="value amber">{{star6}}</div>
      </div>
      <div class="card-wrap overview-item">
        <div class="label">平均出货</div>
        <div class="value">{{globalAvgPity}}</div>
      </div>
    </div>

    {{if showUpBlock}}
    <div class="card-wrap up-block">
      <div class="up-block-left">
        <div><span class="up-tag">当前 UP</span><span class="up-name">{{upName}}</span></div>
        <h3 class="up-title">UP 出货占比 (Win Rate)</h3>
        <p class="up-desc">当前限定池中，UP 角色占所有 6 星出货的比例。</p>
      </div>
      <div class="up-block-right">
        <div class="up-rate-text">
          <div class="up-rate-value">{{upWinRate}}</div>
        </div>
        <div class="up-rate-vertical-wrap">
          <div class="up-rate-vertical-bar"><div class="up-rate-vertical-fill" style="height:{{upWinRateNum}}%;"></div></div>
        </div>
      </div>
    </div>
    {{/if}}

    <div class="channel-grid">
      {{if official}}
      <div class="card-wrap channel-card">
        <div class="card-head">官服数据 (Official) · CN-01</div>
        <div class="card-sub">CHANNEL STATISTICS</div>
        <div class="card-body">
          <div><div class="item-label">用户数</div><div class="item-value">{{official.total_users}}</div></div>
          <div><div class="item-label">总抽数</div><div class="item-value">{{official.total_pulls}}</div></div>
          <div><div class="item-label">6星总数</div><div class="item-value amber">{{official.star6_total}}</div></div>
          <div><div class="item-label">平均出货</div><div class="item-value">{{official.avg_pity}}</div></div>
        </div>
      </div>
      {{/if}}
      {{if bilibili}}
      <div class="card-wrap channel-card">
        <div class="card-head">B服数据 (Bilibili) · CN-02</div>
        <div class="card-sub">CHANNEL STATISTICS</div>
        <div class="card-body">
          <div><div class="item-label">用户数</div><div class="item-value">{{bilibili.total_users}}</div></div>
          <div><div class="item-label">总抽数</div><div class="item-value">{{bilibili.total_pulls}}</div></div>
          <div><div class="item-label">6星总数</div><div class="item-value amber">{{bilibili.star6_total}}</div></div>
          <div><div class="item-label">平均出货</div><div class="item-value">{{bilibili.avg_pity}}</div></div>
        </div>
      </div>
      {{/if}}
    </div>

    <div class="two-col-layout">
      <div class="col-left">
        <div class="card-wrap">
          <div class="section-head">
            <span class="title">数据概览</span>
            <span class="num">01</span>
          </div>
          <div class="section-sub">STATISTICS</div>
          <div class="stats-overview">
            <div class="stat-row">
              <span class="label">平均出货 (Avg)</span>
              <span class="value">{{avgPity}}</span>
            </div>
            <div class="bar-wrap"><div class="bar-fill primary" style="width:{{avgPityPercent}}%;"></div></div>
            <div class="stat-row">
              <span class="label">6星占比 (Rate)</span>
              <span class="value amber">{{star6Rate}}</span>
            </div>
            <div class="bar-wrap"><div class="bar-fill" style="width:{{star6RatePercent}}%;"></div></div>
            <div class="two-col">
              <div>
                <span class="label block">5星数量</span>
                <span class="value purple">{{star5}}</span>
              </div>
              <div>
                <span class="label block">4星数量</span>
                <span class="value blue">{{star4}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-right">
        <div class="card-wrap">
          <div class="section-head">
            <span class="title">{{poolChartTitle}} - 6星出货分布</span>
            <span class="num">02</span>
          </div>
          <div class="section-sub">DISTRIBUTION CHART</div>
          <div class="dist-chart">
            {{each distributionList}}
            <div class="dist-bar-row">
              <div class="dist-bar-outer">
                <span class="dist-count">{{$value.count}}</span>
                <div class="dist-bar" style="height:{{$value.height}}%;"></div>
              </div>
              <span class="dist-label">{{$value.range}}</span>
            </div>
            {{/each}}
          </div>
          <div class="dist-legend">
            <span><i class="dot normal"></i>常规出货</span>
            <span><i class="dot high"></i>高水位 (60+)</span>
          </div>
        </div>
      </div>
    </div>

    {{if showRankingBlock}}
    <!-- 出货排名：整行全宽，左右两列占满（新手池不显示） -->
    <div class="card-wrap ranking-card ranking-card-full">
      <div class="section-head">
        <span class="title">出货排名</span>
        <span class="num">03</span>
      </div>
      <div class="section-sub">SHIPMENT RANKING</div>
      <div class="ranking-two-cols">
        <div class="ranking-col">
          <div class="ranking-col-title star6">★ {{rankingTab6}}</div>
          <div class="ranking-list">
            {{each rankingList6}}
            <div class="ranking-item">
              <span class="rank">{{$index + 1}}</span>
              <div class="name">{{$value.char_name}}{{if $value.isUp}}<span class="up-tag">UP</span>{{/if}}</div>
              <span class="count">{{$value.count}} <span class="percent">({{$value.percent}}%)</span></span>
              <div class="bar-wrap"><div class="bar-fill star6" style="width:{{$value.percent}}%;"></div></div>
            </div>
            {{/each}}
          </div>
        </div>
        <div class="ranking-col">
          <div class="ranking-col-title star5">★ {{rankingTab5}}</div>
          <div class="ranking-list">
            {{each rankingList5}}
            <div class="ranking-item">
              <span class="rank">{{$index + 1}}</span>
              <div class="name">{{$value.char_name}}</div>
              <span class="count">{{$value.count}} <span class="percent">({{$value.percent}}%)</span></span>
              <div class="bar-wrap"><div class="bar-fill star5" style="width:{{$value.percent}}%;"></div></div>
            </div>
            {{/each}}
          </div>
        </div>
      </div>
    </div>
    {{/if}}

    <footer class="footer">
      <div class="copyright"><span class="footer-icon">ⓘ</span> 所有数据来源于已绑定账号的玩家自动同步。数据会缓存 5 分钟以减轻服务器压力。</div>
    </footer>
  </div>
</body>
</html>
